---
title: FF14 黒魔道士スキル回し計算シート 令和最新版
---
FF14で黒魔道士を触ってみることにしたので、まずは座学からと思い、スキル回しごとの合計威力や所要時間を比較できるようなスプレッドシートを用意してみました。尚、この記事はパッチ6.38の時点で記載されています。

[FF14 黒魔道士スキル回し計算シート 令和最新版 - Google スプレッドシート](https://docs.google.com/spreadsheets/d/1mj9B9xkN9WPLitULsOT0alvrgLNQy-zUKYrN7Oa_n9c/edit#gid=1058932485)

使い方
---

「ファイガ」「サンダガ」「ファイジャ」「三連魔」「ファイジャ」……のように、使うアクションの名前を順番に埋めていくだけで、威力や時間等が自動的に表示されるというものです。緑色の部分を入力すると、他の部分が勝手に計算されます。

![](https://lh6.googleusercontent.com/MyXEfWzI87iKGdmexaKLQbilzdNq7sppvHvmxdqGFZAjd8HdnLDw4RIDMSpvGGgn7D7Z3F5S4tj36Ov181Qy6027iYiuwI9U2GJtT229dKHx1LxsJGRqCW-Vf5pvmEGSUDC1vEi7LiCXYq4bvJfb7cE "開幕用のスキル回しの例")

想定利用シーン
-------

どのように利用することを想定しているかと言うと、例えば以下のようなことを考えるときに役に立つだろうと考えています。

*   「AFパラドックスのProc確率40%を威力期待値に置き換えると、このProcのおかげで利用できるWトランス回しにより威力X相当の恩恵が得られる訳だから、この追加効果には威力0.4X相当の期待値があると言えるのではないか」
*   「同様に、激成魔による威力向上の期待値として、パラドックスでは威力0.6X相当の期待値、サンダガでは威力Y相当の期待値があるとして比較できるのではないか」
*   「通常回しが34秒でPPS191、パラア回しは26秒でPPS189、Wトランス回しは18秒でPPS218だから、条件Aの場合はパラア回し、条件Bの場合はWトランス回しに移行するのが適切ではないだろうか」

個人的には、複数のスキル回しを選択できる状況において、それぞれの所要時間、詠唱やサンダガ更新のタイミングを考慮した上で適切なものを選択できるようになると、より黒魔道士を楽しめるようになるだろうと考えています。このスプレッドシートで各種スキル回しを俯瞰することで、その理解の助けになると良いですね。

Googleスプレッドシートの説明
-----------------

Googleスプレッドシートの使い方についても説明しておきます。上述のリンクから閲覧できるスプレッドシートは、私のアカウントが所有している閲覧専用のものになっているので、「ファイル」タブの「コピーを作成」を選び、自分のアカウントで自由に編集できるコピーを作成し、これを利用して編集を行ってください。

このスプレッドシートは、以下のような複数のシートで構成されています。

*   テンプレート
*   開幕サンプル回し
*   通常回し
*   Wトランス回し
*   パラア回し
*   アクションマスター
*   極性マスター
*   仕様マスター

基本的には、”テンプレート” シートをコピーし、新たな回しをそこに書き込んで使うことを想定しています。しかし空っぽの状態では使い方が分からないのではないかと思い、そのサンプルとして幾つか同梱しているのが “○○回し” 系のシート達です。”○○マスター” は、内部実装に利用されているデータ群です。不具合が見つかったり、FF14のアップデートで仕様が変わったりした場合には、今後この辺のシートの内容にも見直しが入ることになるでしょう。

使い方の説明は以上です。

小一時間程度でつくったものなので、恐らく不具合が幾つか含まれているだろうと思いますが、何かの参考になればと思います。

* * *

ここから先は、細かい仕様や内部実装に関する話を記載する予定ですので、シートを利用する上ではあまり読む必要の無い話です。将来、仕組みを忘れた頃に保守することになった自分や、似たものを実装したい方の参考になればと思い記載します。

極性
--

黒魔道士にはAF1状態やUB3状態といった極性があります。アクション実行時の極性を手入力させるのは避けたいため、実行されるアクション名を元に自動的に極性が遷移していくように実装しました。ファイガを撃つとAF3状態になり、ブリザガを撃つとUB3状態になり、またAF1状態のときにファイアを撃つとAF2状態になり……といった話ですね。ファイガとデスペアのように同じ挙動になるアクションが幾つかあるので、整理すると合計8パターンの遷移があり得ます。

内部実装としては、ファイアやブリザガなどの各アクションごとに、どの遷移パターンをするかの対応表を用意し、現在の状態と実行するアクション名とを照らし合わせることで、次の遷移先を計算させています。また、AF3時の炎属性魔法は威力1.8倍であったり、AF3時の氷属性魔法は詠唱時間0.5倍であったりと、極性や魔法属性ごとに詠唱時間や威力に補正が掛かる場合があるので、この対応も記載しています。これらが記載されているのが、“アクションマスター” と “極性マスター” のシートです。

このような事情があり、利用者には正確なアクション名を記載してもらう必要があるため、アクション名の入力欄にはプルダウンメニューを採用しました。このメニューの選択候補には、アクションマスターに羅列されたアクション名が表示されるようになっています。プルダウンメニューは一見マウスで操作しないといけないような見た目をしていますが、普通にキーボードでアクション名を入力することもできるため、これにより入力がしづらくなることはそこまで無いだろうと考えています。

サンダガ
----

サンダガの威力については、一覧には着弾時の威力だけを表示している一方、全体の合計威力には継続ダメージの分も含めています。2回目以降のサンダガ着弾時とスキル回し終了時に、それまでに掛かっていたサンダガの継続ダメージの合計威力を計算し、スキル回し全体の合計威力に計上する、というような処理が施されています。

黒魔紋
---

黒魔紋が利用されると、30秒間、魔法のキャストタイムとリキャストタイムが15%短縮されます。これは「黒魔紋を考慮した現在のGCD」を各アクションの実行ごとにまず計算させ、この値を元に詠唱時間等を計算するようにすることで対応しています。この「黒魔紋を考慮した現在のGCD」の値の計算については、そのアクションの詠唱開始時刻が直近に実行された黒魔紋の詠唱完了時刻から30秒以内であれば、素のGCDから15%短縮する、といった計算処理で素朴に実現しています。

無詠唱化
----

迅速魔や三連魔など、後の詠唱魔法が無詠唱化されるアビリティについては、「現在の無詠唱化スタック数」を状態として管理していくことで対応しています。”アクションマスター” シートにおいて、三連魔はスタック数に+3する、迅速魔はスタック数に+1する、ファイアはスタック数に-1する、Procファイガはスタック数に+0する、といった対応が記載されており、アクションが実行されるたびに「現在の無詠唱化スタック数」の値を増減させていっています。この仕組みにより、アクション名を入力するだけで、俗に言うキャスター税等を含めた各魔法の正確な詠唱時間が計算できるようになっています。

他に考慮すべき点として、極性がUBでパラドックスシンボルがあるときは、パラドックスが無詠唱になります。勿論これはそれまでのアクション実行履歴から計算可能なので、そのように対処しています。

開幕前のアビリティ
---------

激成魔や黒魔紋など、戦闘開始前にアビリティを実行しておくケースがよくありますが、これは事前に実行するので合計時間に含めておいてほしくありません。そこで特殊な処理として、先頭のアビリティ群の実行時間は無視するようになっています。

非表示のカラム
-------

保守性を上げるために内部実装も分かりやすくしておこうということで、利用者に見せる必要の無い計算結果についても、ある程度の単位で非表示の列内に残してあります。例えば、サンダガの継続ダメージの計算についての内部情報や、現在の無詠唱化スタック数、パラドックスシンボルの状態等が挙げられます。これらの値は、列名の三角形のマークをクリックすることで再表示できます。また、複数列を選択した上で右クリックすることで、再度非表示にできます。
